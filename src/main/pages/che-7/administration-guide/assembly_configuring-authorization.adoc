---
title: "Configuring authorization"
keywords: organizations, user management, permissions
tags: [ldap, keycloak]
sidebar: che_7_docs
permalink: che-7/configuring-authorization/
folder: che-7/administration-guide
summary: 
---

:parent-context-of-configuring-authorization: {context}

:context: configuring-authorization

[id="authorization-and-user-management_{context}"]
== Authorization and user management

Eclipse Che uses http://www.Keycloak.org[Keycloak] to create, import, manage, delete, and authenticate users. Keycloak uses built-in authentication mechanisms and user storage. It can use third-party identity management systems to create and authenticate users. Eclipse Che requires a Keycloak token when you request access to Che resources.

Local users and imported federation users must have an email address in their profile.

The default Keycloak credentials are `admin:admin`. You can use the `admin:admin` credentials when logging into Che for the first time. It has system privileges. 

To find your Keycloak URL:

ifeval::["{project-context}" == "che"]
If Che is running on Kubernetes:

* Go to `$CHE_HOST:5050/auth`.

If Che is deployed on OpenShift:
endif::[]

* Go to the OpenShift web console and navigate to the *Keycloak* namespace. 

[id="configuring-che-to-work-with-keycloak_{context}"]
== Configuring Che to work with Keycloak

The deployment script configures Keycloak. It creates a `che-public` client with the following fields:

* *Valid Redirect URIs*: Use this URL to access Che. 
* *Web Origins*

The following are common errors when configuring Che to work with Keycloak: 

*Invalid `redirectURI` error*: occurs when you access Che at `myhost`, which is an alias, and your original `CHE_HOST` is `1.1.1.1`. If this error occurs, go to the Keycloak administration console and ensure that the valid redirect URIs are configured.

*CORS error*: occurs when you have an invalid web origin


[id="configuring-keycloak-tokens_{context}"]
== Configuring Keycloak tokens

A user token expires after 30 minutes by default. 

You can change the following Keycloak token settings:

image::keycloak/keycloak_realm.png[link="{imagesdir}/keycloak/keycloak_realm.png"]


[id="setting-up-user-federation_{context}"]
== Setting up user federation

Keycloak federates external user databases and supports LDAP and Active Directory. You can test the connection and authenticate users before choosing a storage provider.

See the http://www.keycloak.org/docs/3.2/server_admin/topics/user-federation.html[User storage federation] page in Keycloak documentation to learn how to add a provider.

See the http://www.keycloak.org/docs/3.2/server_admin/topics/user-federation/ldap.html[LDAP and Active Directory] page in Keycloak documentation to specify multiple LDAP servers.


[id="enabling-authentication-with-social-accounts-and-brokering_{context}"]
== Enabling authentication with social accounts and brokering

Keycloak provides built-in support for GitHub, OpenShift, and most common social networks such as Facebook and Twitter. See Instructions to http://www.keycloak.org/docs/3.2/server_admin/topics/identity-broker/social/github.html[enable Login with GitHub].

You can also enable the SSH key and upload it to the Che usersâ€™ GitHub accounts. 

To enable this feature when you register a GitHub identity provider: 

. Set scope to `repo,user,write:public_key`.

. Set store tokens and stored tokens readable to *ON*.
+
image::git/kc_provider.png[link="{imagesdir}/git/kc_provider.png"]

. Add a default read-token role.
+
image::git/kc_roles.png[link="{imagesdir}/git/kc_roles.png"]

This is the default `delegated` OAuth service mode for multi-user Che. You can configure the OAuth service mode with the property `che.oauth.service_mode`.

// TODO: To use Che's OAuth Authenticator, set `che.oauth.service_mode` to `embedded` and use link:{site-baseurl}che-7/version-control/[Instructions for single-user mode].

// TODO: See link:ide_projects.html#importing-projects-in-the-ide[SSH key management] for more information.


[id="using-protocol-based-providers_{context}"]
== Using protocol-based providers

Keycloak supports http://www.Keycloak.org/docs/3.2/server_admin/topics/identity-broker/saml.html[SAML v2.0] and http://www.Keycloak.org/docs/3.2/server_admin/topics/identity-broker/oidc.html[OpenID Connect v1.0] protocols. You can connect your identity provider systems if they support these protocols.


[id="managing-users_{context}"]
== Managing users 

You can add, delete, and edit users in the user interface. See: http://www.Keycloak.org/docs/3.2/server_admin/topics/users.html[Keycloak User Management] for more information.


[id="smtp-configurationemail-notifications_{context}"]
== Configuring SMTP and email notifications

Eclipse Che does not provide any pre-configured MTP servers. 

To enable SMTP servers in Keycloak:

. Go to `che realm settings > Email`. 

. Specify the host, port, username, and password. 

Eclipse Che uses the default theme for email templates for registration, email confirmation, password recovery, and failed login.

:context: {parent-context-of-configuring-authorization}
