// Module included in the following assemblies:
//
// installing-{prod-id-short}-on-google-cloud-platform
// installing-{prod-id-short}-on-aws
// installing-{prod-id-short}-on-microsoft-azure


[id="installing-{prod-id-short}-on-kubernetes-using-{prod-cli}_and_helm_{context}"]
= Installing {prod-short} on {k8s-platform} using {prod-cli}

.Prerequisites

* The `{prod-cli}` management tool is available. See xref:using-the-chectl-management-tool.adoc[].
* The `helm` tool is available, with version 2.15 or higher. See link:https://helm.sh/[Helm].

.Procedure

* To install {prod-short} on {k8s-platform}, run the following `{prod-cli}` command:
+
[subs="+attributes"]
----
$ {prod-cli} server:deploy --installer=helm --platform=k8s --domain={domain} --multiuser
  âœ” Verify Kubernetes API...OK
  âœ” ğŸ‘€  Looking for an already existing {prod} instance
    âœ” Verify if {prod} is deployed into {orch-namespace} "{prod-namespace}"...it is not
  âœ” âœˆï¸  {kubernetes} preflight checklist
    âœ” Verify if kubectl is installed
    âœ” Verify remote kubernetes status...done.
    âœ” Check {kubernetes} version: Found v1.15.12-gke.2.
    âœ” Verify domain is set...set to {domain}.
    â†“ Check if cluster accessible [skipped]
  âœ” Start following logs
    â†“ Start following Operator logs [skipped]
    âœ” Start following {prod} logs...done
    âœ” Start following Postgres logs...done
    âœ” Start following {identity-provider} logs...done
    âœ” Start following Plugin registry logs...done
    âœ” Start following Devfile registry logs...done
  âœ” Start following events
    âœ” Start following {orch-namespace} events...done
 â€º   Warning: Consider using the more reliable 'OLM' installer when deploying a stable release of {prod-short} (--installer=olm).
  âœ” ğŸƒâ€  Running Helm to install {prod}
    âœ” Verify if helm is installed
    âœ” Check Helm Version: Found v3.1.2+gd878d4d
    âœ” Create Namespace (che)...does already exist.
    âœ” Check {prod} TLS certificate...TLS certificate secret found
    âœ” Check Cluster Role Binding...does not exists.
    âœ” Preparing {prod} Helm Chart...done.
    âœ” Updating Helm Chart dependencies...done.
    âœ” Deploying {prod} Helm Chart...done.
  âœ” âœ…  Post installation checklist
    âœ” PostgreSQL pod bootstrap
      âœ” scheduling...done.
      âœ” downloading images...done.
      âœ” starting...done.
    âœ” Devfile registry pod bootstrap
      âœ” scheduling...done.
      âœ” downloading images...done.
      âœ” starting...done.
    âœ” Plugin registry pod bootstrap
      âœ” scheduling...done.
      âœ” downloading images...done.
      âœ” starting...done.
    âœ” {prod} pod bootstrap
      âœ” scheduling...done.
      âœ” downloading images...done.
      âœ” starting...done.
    âœ” Retrieving {prod} server URL... https://{prod-namespace}-{prod-namespace}.{domain}
    âœ” {prod} status check
  âœ” Show important messages
    âœ” Autogenerated {identity-provider} credentials are: "xxx:xxx"
Command server:deploy has completed successfully.
----

.Verification steps

. Track installation events with:
+
[subs="+attributes"]
----
$ kubectl get events --namespace {prod-namespace} --sort-by=.metadata.creationTimestamp
----

. Verify that certificates are set correctly
.. Open {prod} server URL from the output above
.. Click on the lock in address bar
.. Verify it has **Connection is secure**

.Additional resources

* xref:end-user-guide:navigating-che-using-the-dashboard.adoc[].
