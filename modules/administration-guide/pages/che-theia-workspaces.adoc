[id="che-theia-workspaces"]
// = Che-Theia workspaces
:navtitle: Che-Theia workspaces
:keywords: che-theia, workspaces
:page-aliases: extensions:che-theia-workspaces

= Che-Theia workspaces

[id="telemetry-overview_{context}"]
== Telemetry overview
:context: telemetry-overview

Telemetry is the explicit and ethical collection of operation data. By default, telemetry is not available in {prod}, but in the Che-Theia editor there is an abstract API that allows enabling telemetry using the plug-in mechanism and in the `chectl` command line tool usage data can be collected using segment. This approach is used in the xref:hosted-che:hosted-che.adoc[] service where telemetry is enabled for every Che-Theia workspace.

This documentation includes a guide describing how to make your own telemetry client for {prod}, followed by an overview of the link:https://github.com/che-incubator/che-workspace-telemetry-woopra-plugin[{prod} Woopra Telemetry Plugin].

== Use cases
[id="use-cases_{context}"]

{prod} telemetry API allows tracking:

* Duration of a workspace utilization
* User-driven actions such as file editing, committing, and pushing to remote repositories.
* The list of plug-ins enabled in a workspace
* Programming languages and devfiles used in workspaces.

== How it works
[id="how-it-works_{context}"]

When a {prod-short} workspace starts, the `che-theia` container starts the telemetry plug-in, which is responsible for sending telemetry events to a backend. If the `$CHE_WORKSPACE_TELEMETRY_BACKEND_PORT` environment variable was set in the workspace Pod, the telemetry plug-in will send events to a backend listening at that port.

If the {prod-short} workspace has a telemetry back-end container running, and it is listening on `$CHE_WORKSPACE_TELEMETRY_BACKEND_PORT`, it takes the events sent from the telemetry plug-in, turns them into the backend-specific representation of events, and sends them to the configured analytics backend (for example, Segment or Woopra).

image::telemetry/telemetry_diagram.png[]

=== {devworkspace} telemetry

Telemetry for {devworkspace}s works similarly to telemetry for {prod-short} workspaces, with the main differences being:

. A {devworkspace} telemetry plug-in listens for events on `$DEVWORKSPACE_TELEMETRY_BACKEND_PORT` instead of `$CHE_WORKSPACE_TELEMETRY_BACKEND_PORT`.

. The {devworkspace} telemetry plug-in requires version 0.0.34 or later of the link:https://github.com/che-incubator/che-workspace-telemetry-client/tree/master/backend-base[telemetry plug-in dependency].

== Events sent to the backend by the Che-Theia telemetry plug-in

[cols="2,5", options="header"]
:=== 
 Event: Description 
WORKSPACE_OPENED: Sent when Che-Theia starts running
COMMIT_LOCALLY: Sent when a commit was made locally with the `git.commit` Theia command
PUSH_TO_REMOTE: Sent when a Git push was made with the `git.push` Theia command
EDITOR_USED: Sent when a file was changed within the editor
:=== 

Other events such as `WORKSPACE_INACTIVE` and `WORKSPACE_STOPPED` can be detected within the back-end plug-in.
