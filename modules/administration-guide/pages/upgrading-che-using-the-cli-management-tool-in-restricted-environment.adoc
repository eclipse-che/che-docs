:_content-type: PROCEDURE
:navtitle: Upgrading {prod-short} in restricted environment
:keywords: Upgrading {prod-short} in restricted environment
:page-aliases: installation-guide:upgrading-che-using-the-cli-management-tool-in-restricted-environment, installation-guide:upgrading-che-in-restricted-environment

:parent-context-of-upgrading-prod-short-using-the-cli-management-tool-in-restricted-environment: {context}

[id="upgrading-{prod-id-short}-using-the-cli-management-tool-in-restricted-environment_{context}"]
= Upgrading {prod-short} using the CLI management tool in restricted environment

:context: upgrading-prod-short-using-the-cli-management-tool-in-restricted-environment

This section describes how to upgrade {prod} using the CLI management tool in restricted environment. The upgrade path supports minor version update, from {prod-short} {prod-prev-ver} to version {prod-ver}.

.Prerequisites

* An administrative account on an instance of {platforms-name}.

* An instance running {prod-short} {prod-prev-ver}, installed using the CLI management tool on the same instance of {platforms-name}, with the {prod-cli} `--installer operator` method, in the `_<{prod-namespace}>_` project. See xref:installing-che-in-a-restricted-environment.adoc[].

* The `{prod-cli}` {prod-ver} management tool is available. See xref:using-the-chectl-management-tool.adoc[].

* Essential container images are available to the {prod-short} server running in the cluster. See xref:preparing-a-restricted-environment.adoc[].

.Procedure

. In all running workspaces in the {prod-short} {prod-prev-ver} instance, save and push changes back to the Git repositories.

. Stop all workspaces in the {prod-short} {prod-prev-ver} instance.

. Run the following command:
+
[subs="+attributes,+quotes"]
----
$ {prod-cli} server:update --che-operator-image=__<image-registry>__/__<organization>__/{prod-operator-image-name}:{prod-ver} -n {prod-namespace}
----
+
* _<image-registry>_: A hostname and a port of the container-image registry accessible in the restricted environment.
* _<organization>_: An organization of the container-image registry. See: See xref:preparing-a-restricted-environment.adoc[].

.Verification steps

. Navigate to the {prod-short} instance.

. The {prod-ver} version number is visible at the bottom of the page.

[NOTE]
====
For slow systems or internet connections, add the `--k8spodwaittimeout=1800000` flag option to the `{prod-cli} server:update` command to extend the Pod timeout period to 1800000 ms or longer. 
====

